LIGNES = 6
COLONNES = 7

def creer_grille():
    return [[0 for _ in range(COLONNES)] for _ in range(LIGNES)]

def afficher_grille(grille):
    for ligne in reversed(grille):
        print(" | ".join(str(x) if x != 0 else "." for x in ligne))
    print("-" * (COLONNES * 4 - 1))

def mouvement_valide(grille, col):
    return grille[LIGNES-1][col] == 0

def obtenir_ligne_disponible(grille, col):
    for ligne in range(LIGNES):
        if grille[ligne][col] == 0:
            return ligne

def placer_piece(grille, ligne, col, piece):
    grille[ligne][col] = piece

def verifier_victoire(grille, piece):
    for c in range(COLONNES-3):
        for l in range(LIGNES):
            if all(grille[l][c+i] == piece for i in range(4)):
                return True

    for c in range(COLONNES):
        for l in range(LIGNES-3):
            if all(grille[l+i][c] == piece for i in range(4)):
                return True

    for c in range(COLONNES-3):
        for l in range(LIGNES-3):
            if all(grille[l+i][c+i] == piece for i in range(4)):
                return True

    for c in range(COLONNES-3):
        for l in range(3, LIGNES):
            if all(grille[l-i][c+i] == piece for i in range(4)):
                return True

    return False

def puissance4():
    grille = creer_grille()
    game_over = False
    tour = 0

    print("Bienvenue dans le Puissance 4")
    print("Joueur 1: X & Joueur 2: O")

    while not game_over:
        afficher_grille(grille)

        col = int(input(f"Joueur {tour+1} - Choisis une colonne (0-{COLONNES-1}): "))

        if 0 <= col < COLONNES and mouvement_valide(grille, col):
            ligne = obtenir_ligne_disponible(grille, col)
            piece = "X" if tour == 0 else "O"
            placer_piece(grille, ligne, col, piece)

            if verifier_victoire(grille, piece):
                afficher_grille(grille)
                print(f"Joueur {tour+1} ({piece}) gagne")
                game_over = True
        else:
            print("Coup invalide, choisis une autre colonne.")

        tour = (tour + 1) % 2

puissance4()
